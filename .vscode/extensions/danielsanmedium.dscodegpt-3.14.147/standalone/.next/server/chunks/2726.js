try{let a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},b=(new a.Error).stack;b&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[b]="8b29eb52-55cc-464c-9657-ffaa04f51bbc",a._sentryDebugIdIdentifier="sentry-dbid-8b29eb52-55cc-464c-9657-ffaa04f51bbc")}catch(a){}"use strict";exports.id=2726,exports.ids=[2726],exports.modules={21822:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{N:()=>h});var e=c(43084),f=c(13234),g=a([e,f]);async function h(){try{let a=await (0,e.fm)("codegpt-enterprise-config");if(a?.organizationId)return a.organizationId}catch(a){console.error("Error loading enterprise configuration:",a)}let a=f.FI.getByProvider("CodeGPT Plus Beta");return a?.organization_id??void 0}[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})},22726:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{LD:()=>r,Ru:()=>u,UM:()=>t,Ys:()=>n,_d:()=>q,rL:()=>v,x1:()=>s});var e=c(43084),f=c(70377),g=c(13234),h=c(827),i=c(82269),j=c(21822),k=c(80948),l=c(9298),m=a([e,f,g,h,i,j]);[e,f,g,h,i,j]=m.then?(await m)():m;let n=new RegExp(["csv","tsv","psv","dsv","dat","xlsb","prn","sdf","tsk","xml","rdata","rds","parquet","avro","orc","feather","h5","hdf5","pkl","arff","csvz","tsvz","ndjson"].map(a=>`\\.${a}$`).join("|")),o=async()=>{try{let a=await (0,e.CA)();if(!a)return{projectId:"",workspaceFolder:""};let b=await g.Hv.get(a);return b||(b=crypto.randomUUID(),g.Hv.upsert({key:a,value:b})),{projectId:b,workspaceFolder:a}}catch{return{projectId:"",workspaceFolder:""}}},p=async a=>{let b=new TextEncoder().encode(a),c=await crypto.subtle.digest("SHA-256",b);return Array.from(new Uint8Array(c)).map(a=>a.toString(16).padStart(2,"0")).join("")},q=async({request:a,session:b})=>{try{let c=await (0,j.N)(),d=await (0,i.m)(),e=await fetch(`${d}/codebase/insert-chunks-v2`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json",...c?{"CodeGPT-Org-Id":c}:{}},body:JSON.stringify({...a,codegraph:a.codegraph||!1})});if(console.log({url:`${d}/codebase/insert-chunks-v2`,status:e.status}),!e.ok)throw Error(`No response from ${d}`)}catch(a){return console.error(`insertChunks: ${a.message}`),!1}return!0},r=async()=>{try{let{projectId:a,workspaceFolder:b}=await o();if(!a||!b)return null;let c=await (0,f.A)(),d=g.FI.getByProvider("CodeGPT Plus Beta")?.apikey,e=await (0,j.N)(),h=await fetch(`${l.X1}/codebase/workspace-id-v2`,{method:"POST",headers:{Authorization:`Bearer ${c||d}`,"Content-Type":"application/json",...e?{"CodeGPT-Org-Id":e}:{}},body:JSON.stringify({projectId:a,name:b})});if(!h.ok){let a=await h.text();throw console.log(a),Error(`No response from ${l.X1}`)}return await h.json()}catch(a){return console.error(`getWorkspaceId: ${a.message}`),null}},s=async({fileName:a,fileContent:b})=>{let c="object"==typeof b?JSON.stringify(b,void 0,2):b;if(""===c.trim()||a.endsWith("json")&&c.split("\n").length>2e3)return[];let d=c.split("\n");if(d.length>1e4||d[0].length>5e3)return[];let e=await (0,k.K)({content:c,maxLines:25,overlapLines:3,trimEmpty:!1}),f=await Promise.all(e.map(a=>p(a.content)));return e.map((b,c)=>({content:b.content,startLine:b.startLine,endLine:b.endLine,fileName:a,hash:f[c]}))},t=async({chunks:a,workspaceId:b,session:c,codegraph:d})=>{try{if(a.length>0)return await q({request:{workspaceId:b,codegraph:d,chunks:a},session:c}),a;return[]}catch(a){if(console.error("Failed to generate embeddings:",a.message),a.message.includes("getEmbeddings"))throw Error(`Failed to get Embeddings from API - ${a.message}`);return[]}},u=async({workspaceId:a,session:b})=>{try{let c=g.vz.get(a)?.map(a=>a.hash);if(!c||0===c.length){let d=await (0,i.m)(),e=await fetch(`${d}/codebase/hashes/${a}`,{method:"GET",headers:{Authorization:`Bearer ${b}`}});if(!e.ok)throw Error(`No response from ${d}`);c=await e.json()}return c||[]}catch(a){return console.error(`getDBHashes: ${a.message}`),[]}},v=async({workspaceId:a,session:b,hashes:c})=>{try{b||=await (0,f.A)();let d=await (0,j.N)(),e=await (0,i.m)();console.log("TRYING TO REMOVE HASHES");let g=await fetch(`${e}/codebase/clean`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json",...d?{"CodeGPT-Org-Id":d}:{}},body:JSON.stringify({workspaceId:a,hashes:c})});if(console.log({response:g}),!g.ok)throw Error(`No response from ${e} ${g.status}`);return await g.json()}catch(a){return console.error(`removeHashes: ${a.message}`),null}};d()}catch(a){d(a)}})},80948:(a,b,c)=>{async function d({content:a,maxLines:b,overlapLines:c,trimEmpty:d=!0,minLines:e=1}){if(b<=0)throw Error("maxLines must be positive");if(c>=b)throw Error("overlapLines must be less than maxLines");if(c<0)throw Error("overlapLines must be non-negative");if(e>b)throw Error("minLines must be less than or equal to maxLines");if(e<=0)throw Error("minLines must be positive");let f=a.split("\n");d&&(f=f.filter(a=>a.trim().length>0));let g=[];if(f.length<=b)return[{content:f.join("\n"),startLine:0,endLine:f.length-1}];let h=0,i=0,j=2*Math.ceil(f.length/(b-c));for(;h<f.length;){if(++i>j){console.warn("Maximum iterations reached. Processing remaining content as final chunk.");let a=f.slice(h);a.length>0&&g.push({content:a.join("\n"),startLine:h,endLine:f.length-1});break}let a=Math.min(h+b,f.length);if(a<f.length){let c=Math.min(a+Math.floor(b/2),f.length),d=!1;for(let b=a;b<c;b++)if(""===f[b].trim()){a=b+1,d=!0;break}d||(a=Math.min(h+b,f.length))}a-h<e&&(a=Math.min(h+e,f.length));let d=f.slice(h,a).join("\n");d.trim().length>0&&g.push({content:d,startLine:h,endLine:a-1});let k=a-c;if(k<=h?h+=1:h=k,a>=f.length)break}if(g.length>1){let a=g[g.length-1];if(a.endLine-a.startLine+1<10){let b=g[g.length-2],c=Math.max(0,b.endLine-a.startLine+1),d=a.content.split("\n").slice(c);b.content=b.content+(d.length>0?"\n"+d.join("\n"):""),b.endLine=a.endLine,g.pop()}}return g}c.d(b,{K:()=>d}),c(46663)},82269:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{m:()=>h});var e=c(43084),f=c(9298),g=a([e]);async function h(){try{let a=await (0,e.fm)("codegpt-enterprise-config");if(a?.customLink){let b=a.customLink;if(b.includes("api.codegpt.co"))return b.replace("api.codegpt.co","index.codegpt.co");if(b.endsWith("/api/v1")){let a=b.substring(0,b.lastIndexOf("/api/v1"));try{let b=new URL(a),c=b.hostname.split(".");if("api"===c[0])return c[0]="index",b.hostname=c.join("."),b.toString()+"/api/v1"}catch{}}return b}}catch(a){console.error("Error loading enterprise configuration:",a)}return f.X1}e=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})}};
//# sourceMappingURL=2726.js.map